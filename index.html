<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Divine Path - Full Astrology & Numerology Suite</title>
  <style>
    /* Import font */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: #10101c;
      font-family: 'Poppins', sans-serif;
      color: #eee;
      min-height: 100vh;
      padding: 25px 15px;
      user-select: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      scroll-behavior: smooth;
    }

    header h1 {
      font-size: 2.8rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: #ff7100;
      text-shadow: 0 0 15px #ff8d21cc;
      text-align:center;
      user-select:none;
    }

    header p.subtitle {
      font-size: 1.125rem;
      font-weight: 400;
      color: #a7a1adcc;
      margin-bottom: 30px;
      text-align: center;
    }

    /* Tabs styling */
    #tabs {
      display: flex;
      justify-content: center;
      gap: 14px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }
    .tab-btn {
      background: none;
      border: 2px solid #ff8c13aa;
      padding: 10px 24px;
      border-radius: 40px;
      font-weight: 700;
      font-size: 1rem;
      color: #ffa832cc;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      user-select:none;
      min-width: 120px;
      text-align:center;
      white-space:nowrap;
    }
    .tab-btn.active,
    .tab-btn:hover {
      background: #ffa832d0;
      color: #301a00;
      border-color: #ffa832d0;
    }

    /* Calculator section styling */
    section.calculator-section {
      background: #1b2036cc;
      border-radius: 20px;
      box-shadow: 0 0 45px #ff964bba;
      padding: 36px 50px;
      width: 100%;
      max-width: 980px;
      display: none;
      flex-direction: column;
      user-select:none;
    }
    section.calculator-section.active {
      display: flex;
    }

    /* Common form styles */
    form {
      width: 100%;
      max-width: 520px;
      margin: auto;
      margin-bottom: 24px;
    }

    label {
      display: block;
      font-weight: 600;
      color: #ffac49;
      font-size: 1rem;
      user-select:none;
    }

    input, select, button {
      margin: 8px 0 20px 0;
      width: 100%;
      padding: 14px 18px;
      border-radius: 14px;
      border: none;
      font-size: 1.1rem;
      font-family: 'Poppins', sans-serif;
      background-color: #121720;
      color: #ffc365;
      box-shadow: inset 0 0 16px #ffaa0066;
      transition: box-shadow 0.4s ease;
      user-select:none;
    }

    input:focus, select:focus {
      outline: none;
      background-color: #150f00;
      box-shadow: 0 0 30px #ffaa0055;
      color: #fff4de;
    }

    button {
      background: linear-gradient(45deg, #ffb930, #ff8321);
      font-weight: 800;
      letter-spacing: 1.3px;
      color: #4a1f00cc;
      cursor: pointer;
      box-shadow: 0 0 28px #ffb651cc;
      transition: all 0.3s ease;
      user-select:none;
    }

    button:hover {
      background: linear-gradient(45deg, #ffc64b, #ff9723);
      color: #553312;
      box-shadow: 0 0 38px #ffd870ff;
    }

    /* Chart Containers */
    #chart-container, #trad-chart-container {
      background: #121921dd;
      border-radius: 24px;
      padding: 36px 38px 46px 38px;
      box-shadow: 0 0 36px #ff964bba;
      margin-bottom: 40px;
      user-select:none;
    }
    svg {
      max-width: 100%;
      user-select:none;
    }

    .house-label {
      fill: #ffd37dcc;
      font-weight: 800;
      font-size: 22px;
      user-select:none;
      text-shadow: 0 0 16px #aa6a00cc;
    }
    .planet-text {
      fill: #ffc67e;
      font-weight: 900;
      font-size: 18px;
      user-select:none;
      text-shadow: 0 0 14px #ff9a00cc;
    }
    .planet-circle {
      fill: #ff8634;
      stroke: #ffdeb4;
      stroke-width: 2.5;
      cursor: pointer;
      filter: drop-shadow(0 0 10px #ff9a44cc);
      transform-origin: center;
      transition: all 0.4s ease;
      animation: orbit-glow 3.5s ease-in-out infinite;
      user-select:none;
    }
    .planet-circle:hover {
      fill: #fff9df;
      transform: scale(1.4);
      filter: drop-shadow(0 0 28px #ffc86bdd);
    }

    @keyframes orbit-glow {
      0% { filter: drop-shadow(0 0 10px #ff8634aa); }
      50% { filter: drop-shadow(0 0 28px #ffa151dd); }
      100% { filter: drop-shadow(0 0 10px #ff8634aa); }
    }

    /* Analysis Cards */
    #analysis, #analysis-detailed, #num-analysis, #dasha-result {
      background: #121821dd;
      border-radius: 20px;
      padding: 36px 40px;
      color: #ffc985;
      line-height: 1.6;
      font-size: 1.1rem;
      box-shadow: 0 0 26px #da9a20dd;
      margin-bottom: 45px;
      white-space: pre-line;
      user-select:none;
      max-height: 480px;
      overflow-y: auto;
      font-family: 'Poppins', sans-serif;
    }

    #btnAnalysis {
      background: #ffb442cc;
      border: none;
      padding: 16px 44px;
      border-radius: 60px;
      font-weight: 900;
      font-size: 1.15rem;
      cursor: pointer;
      box-shadow: 0 0 40px #ff9a2000;
      color: #4e2800;
      transition: background-color 0.3s ease;
      margin-bottom: 38px;
      user-select:none;
      display: none;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
      display: block;
      text-align:center;
    }

    #btnAnalysis:hover {
      background: #ffc660ee;
      box-shadow: 0 0 60px #ffb347dd;
    }

    /* Responsive */
    @media (max-width: 720px) {
      form {
        max-width: 100%;
        padding: 20px 16px;
      }
      main {
        max-width: 100%;
      }
      #btnAnalysis {
        max-width: 100%;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
<header>
  <h1>Divine Path</h1>
  <p class="subtitle">Tarot, Numerology & Astrology ka Full Integrated Suite</p>
</header>

<div id="tabs">
  <button class="tab-btn active" data-target="astrology">Astrology (Animated Kundli)</button>
  <button class="tab-btn" data-target="traditional-kundli">Traditional Kundli</button>
  <button class="tab-btn" data-target="numerology">Numerology Calculators</button>
  <button class="tab-btn" data-target="dasha">Dasha Calculators</button>
  <button class="tab-btn" data-target="explanations">All-In-One Explanation</button>
</div>

<main>
  <!-- Astrology Tab -->
  <section id="astrology" class="calculator-section active">
    <form id="kundliForm" autocomplete="off">
      <label for="dob">Date of Birth</label>
      <input type="date" id="dob" required />

      <label for="tob">Time of Birth (24h format)</label>
      <input type="time" id="tob" required step="60" value="12:00" />

      <label for="city">Select City (Auto-fill Latitude & Longitude)</label>
      <select id="city">
        <option value="">-- Select City --</option>
        <option value="22.5726,88.3639">Kolkata</option>
        <option value="23.9941,85.3636">Hazaribagh</option>
        <option value="23.3441,85.3096">Ranchi</option>
        <option value="28.6139,77.2090">Delhi</option>
        <option value="19.0760,72.8777">Mumbai</option>
        <option value="12.9716,77.5946">Bengaluru</option>
      </select>

      <label for="lat">Latitude</label>
      <input type="number" id="lat" placeholder="Latitude" step="0.0001" required />

      <label for="lng">Longitude</label>
      <input type="number" id="lng" placeholder="Longitude" step="0.0001" required />

      <button type="submit" id="btnGenerate">Generate Kundli & Chart</button>
    </form>
    <section id="chart-container" aria-label="Animated Kundli Chart"></section>
    <button id="btnAnalysis">Show Detailed Astrology Analysis</button>
    <section id="analysis" aria-live="polite" aria-label="Basic Astrology Summary"></section>
    <section id="analysis-detailed" style="display:none;" aria-live="polite" aria-label="Detailed Astrology Analysis"></section>
  </section>

  <!-- Traditional Kundli Tab -->
  <section id="traditional-kundli" class="calculator-section" aria-label="Traditional Kundli Section">
    <form id="tradForm" autocomplete="off">
      <label for="tradDob">Date of Birth</label>
      <input type="date" id="tradDob" required />

      <label for="tradTob">Time of Birth (24h format)</label>
      <input type="time" id="tradTob" required step="60" value="12:00" />

      <label for="tradCity">Select City (Auto-fill Latitude & Longitude)</label>
      <select id="tradCity">
        <option value="">-- Select City --</option>
        <option value="22.5726,88.3639">Kolkata</option>
        <option value="23.9941,85.3636">Hazaribagh</option>
        <option value="23.3441,85.3096">Ranchi</option>
        <option value="28.6139,77.2090">Delhi</option>
        <option value="19.0760,72.8777">Mumbai</option>
        <option value="12.9716,77.5946">Bengaluru</option>
      </select>

      <label for="tradLat">Latitude</label>
      <input type="number" id="tradLat" placeholder="Latitude" step="0.0001" required />

      <label for="tradLng">Longitude</label>
      <input type="number" id="tradLng" placeholder="Longitude" step="0.0001" required />

      <button type="submit" id="btnGenerateTrad">Generate Traditional Kundli</button>
    </form>
    <section id="trad-chart-container" style="background:#121921; border-radius: 20px; padding: 30px; box-shadow: 0 0 28px #ff7b22cc; max-width: 600px; margin: auto; user-select:none;">
      <!-- Traditional kundli SVG rendered here -->
    </section>
  </section>

  <!-- Numerology Tab -->
  <section id="numerology" class="calculator-section" aria-label="Numerology Section">
    <form id="numForm" autocomplete="off">
      <label for="numName">Full Name (English)</label>
      <input type="text" id="numName" placeholder="Full Name" autocomplete="off" required />
      <label for="numDob">Date of Birth</label>
      <input type="date" id="numDob" required />
      <button type="submit" id="btnNumCalculate">Calculate Numerology</button>
    </form>
    <section id="num-analysis" style="background:#121921;border-radius:20px; padding:30px; box-shadow: 0 0 28px #ff7b22cc; max-width:700px; margin: 24px auto 60px auto; white-space: pre-line; user-select:none;"></section>
  </section>

  <!-- Dasha Tab -->
  <section id="dasha" class="calculator-section" aria-label="Dasha Section">
    <form id="dashaForm" autocomplete="off">
      <label for="dashaDob">Date of Birth</label>
      <input type="date" id="dashaDob" required />
      <label for="dashaTob">Time of Birth (24h format)</label>
      <input type="time" id="dashaTob" required step="60" value="12:00" />
      <button type="submit" id="btnDashaCalculate">Calculate Dasha</button>
    </form>
    <section id="dasha-result" style="background:#121921; border-radius:20px; padding:30px; box-shadow: 0 0 28px #ff7b22cc; max-width:700px; margin: 24px auto 60px auto; white-space: pre-line; user-select:none;"></section>
  </section>

  <!-- Explanations Tab -->
  <section id="explanations" class="calculator-section" aria-label="Explanations Section" style="color:#ffb24c;">
    <h2 style="text-align:center; user-select:none;">‡§∏‡§Æ‡•ç‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ú‡•ç‡§Ø‡•ã‡§§‡§ø‡§∑ ‡§î‡§∞ ‡§Ö‡§Ç‡§ï‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
    <div style="max-width:900px; margin: 0 auto; font-size:1.1rem; line-height:1.6; white-space: pre-line; user-select:none;">
      <p><strong>‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä (Astrology Chart):</strong> ‡§ú‡§®‡•ç‡§Æ ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§î‡§∞ ‡§∞‡§æ‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§≤‡§ó‡•ç‡§® ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§¶‡§∂‡§æ, ‡§Ø‡•ã‡§ó, ‡§Ü‡§¶‡§ø ‡§Æ‡§æ‡§™‡§¶‡§Ç‡§° ‡§Æ‡§Ç‡§ú‡•Ç‡§∞ ‡§ï‡§ø‡§Ø‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>

      <p><strong>‡§™‡§æ‡§∞‡§Ç‡§™‡§∞‡§ø‡§ï ‡§ï‡•Å‡§Ç‡§°‡§≤‡•Ä:</strong> 12 ‡§ò‡§∞‡•ã‡§Ç ‡§µ‡§æ‡§≤‡§æ ‡§µ‡§∞‡•ç‡§ó‡§æ‡§ï‡§æ‡§∞ ‡§Ø‡§æ ‡§µ‡§ï‡•ç‡§∞‡§æ‡§ï‡§æ‡§∞ ‡§§‡§æ‡§≤‡§ø‡§ï‡§æ ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ó‡•ç‡§∞‡§π ‡§µ ‡§∞‡§æ‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§π‡§∞ ‡§ò‡§∞ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•á ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§™‡§π‡§≤‡•Å‡§ì‡§Ç ‡§ï‡§æ ‡§™‡•ç‡§∞‡§§‡§ø‡§®‡§ø‡§ß‡§ø‡§§‡•ç‡§µ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§</p>

      <p><strong>‡§Ö‡§Ç‡§ï‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞:</strong> ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§ú‡§®‡•ç‡§Æ‡§§‡§ø‡§•‡§ø ‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤‡•á ‡§ó‡§è ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§Ö‡§Ç‡§ï ‡§ú‡•à‡§∏‡•á ‡§ú‡•Ä‡§µ‡§® ‡§™‡§• ‡§Ö‡§Ç‡§ï, ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§§‡•ç‡§µ ‡§Ö‡§Ç‡§ï ‡§Ü‡§¶‡§ø, ‡§ú‡•ã ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§∏‡•ç‡§µ‡§≠‡§æ‡§µ ‡§î‡§∞ ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>

      <p><strong>‡§¶‡§∂‡§æ ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä:</strong> ‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§æ‡§≤‡•Ä‡§Ø ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£, ‡§µ‡§ø‡§∂‡•á‡§∑‡§ï‡§∞ ‡§µ‡§ø‡§Æ‡§∂‡•ã‡§§‡•ç‡§§‡§∞‡•Ä ‡§¶‡§∂‡§æ, ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø‡§´‡§≤ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§</p>

      <p><strong>‡§∏‡§≠‡•Ä ‡§ó‡§£‡§®‡§æ‡§è‡§Å:</strong> ‡§â‡§™‡§∞‡•ã‡§ï‡•ç‡§§ ‡§∏‡§≠‡•Ä ‡§Æ‡•â‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§ú‡•ç‡§Ø‡•ã‡§§‡§ø‡§∑‡•Ä‡§Ø ‡§î‡§∞ ‡§Ö‡§Ç‡§ï‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§î‡§∞ ‡§∏‡§ü‡•Ä‡§ï ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ï‡§ø‡§Ø‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£ ‡§î‡§∞ ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§æ‡§∞‡§æ ‡§ï‡•ã‡§° ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü-‡§∏‡§æ‡§á‡§° ‡§∏‡§ø‡§Ç‡§ó‡§≤ ‡§™‡•á‡§ú ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§æ‡§π‡§ø‡§§ ‡§π‡•à‡•§</p>
    </div>
  </section>
</main>

<script>
  // Tab switching
  const tabs = document.querySelectorAll(".tab-btn");
  const sections = document.querySelectorAll(".calculator-section");
  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tab.classList.add("active");
      const target = tab.dataset.target;
      sections.forEach(s => {
        s.classList.toggle("active", s.id === target);
      });
    });
  });

  /* Common Astrology & Calculation Utilities */
  class Astronomy {
    static toJulianDay(y,m,d,h,min) {
      if(m<=2) {
        y-=1; m+=12;
      }
      const A=Math.floor(y/100), B=2-A+Math.floor(A/4);
      const dayFrac=(h+min/60)/24;
      return Math.floor(365.25*(y+4716))+Math.floor(30.6001*(m+1))+d+dayFrac+B-1524.5;
    }
    static degToRad(d) {return d*Math.PI/180;}
    static radToDeg(r) {return r*180/Math.PI;}
    static sunLongitude(JD) {
      const n=JD-2451545.0;
      const L=(280.460+0.9856474*n)%360;
      const g=(357.528+0.9856003*n)%360;
      const gRad=this.degToRad(g);
      let lambda=L+1.915*Math.sin(gRad)+0.020*Math.sin(2*gRad);
      return (lambda+360)%360;
    }
    static moonLongitude(JD) {
      const n=JD-2451550.1;
      const L=(218.316+13.176396*n)%360;
      const M=(134.963+13.064993*n)%360;
      const F=(93.272+13.229350*n)%360;
      const LRad=this.degToRad(L);
      const MRad=this.degToRad(M);
      const FRad=this.degToRad(F);
      let lambda=L+6.289*Math.sin(MRad)-3.0*Math.sin(LRad-this.degToRad(297.850))+
                 1.274*Math.sin(2*this.degToRad(L)-MRad)+0.658*Math.sin(2*LRad)+
                 0.214*Math.sin(2*MRad)-0.186*Math.sin(this.degToRad(297.850))+
                 0.114*Math.sin(2*FRad);
      return (lambda+360)%360;
    }
    static mercuryLongitude(JD) { return (252.25084 + 4.0923344368*(JD-2451545.0))%360 + 360 %360;}
    static venusLongitude(JD) { return (181.9798 + 1.6021302244*(JD-2451545.0))%360 + 360 %360;}
    static marsLongitude(JD) { return (355.433 + 0.5240207766*(JD-2451545.0))%360 + 360 %360;}
    static jupiterLongitude(JD) { return (34.3515 + 0.083091*(JD-2451545.0))%360 + 360 %360;}
    static saturnLongitude(JD) { return (50.07745 + 0.0300657*(JD-2451545.0))%360 + 360 %360;}
    static greenwichSiderealTime(JD) {
      const JD0=Math.floor(JD+0.5)-0.5;
      const S=JD0-2451545.0;
      const T=S/36525.0;
      const T0=6.697374558+2400.051336*T+0.000025862*T*T;
      const UT=(JD-JD0)*24;
      let GST=T0+UT*1.002737909;
      GST=(GST%24)*15;
      if(GST<0) GST+=360;
      return GST;
    }
  }

  /* Helpers */
  const signs = ["‡§Æ‡•á‡§∑","‡§µ‡•É‡§∑‡§≠","‡§Æ‡§ø‡§•‡•Å‡§®","‡§ï‡§∞‡•ç‡§ï","‡§∏‡§ø‡§Ç‡§π","‡§ï‡§®‡•ç‡§Ø‡§æ","‡§§‡•Å‡§≤‡§æ","‡§µ‡•É‡§∂‡•ç‡§ö‡§ø‡§ï","‡§ß‡§®‡•Å","‡§Æ‡§ï‡§∞","‡§ï‡•Å‡§Æ‡•ç‡§≠","‡§Æ‡•Ä‡§®"];
  function formatLongitude(lon) {
    let normLon=lon%360; if(normLon<0) normLon+=360;
    const signIndex=Math.floor(normLon/30);
    const degreeSign=normLon%30;
    return `${degreeSign.toFixed(2)}¬∞ ${signs[signIndex]}`;
  }

  /* Astrology (Animated Kundli) Logic */
  const astrologyForm=document.getElementById("kundliForm");
  const chartContainer=document.getElementById("chart-container");
  const analysisBasic=document.getElementById("analysis");
  const btnAnalysis=document.getElementById("btnAnalysis");
  const analysisDetailed=document.getElementById("analysis-detailed");

  function calculatePlanets(jd) {
    return [
      {name:"Surya",longitude:Astronomy.sunLongitude(jd)},
      {name:"Chandra",longitude:Astronomy.moonLongitude(jd)},
      {name:"Budh",longitude:Astronomy.mercuryLongitude(jd)},
      {name:"Shukra",longitude:Astronomy.venusLongitude(jd)},
      {name:"Mangal",longitude:Astronomy.marsLongitude(jd)},
      {name:"Guru",longitude:Astronomy.jupiterLongitude(jd)},
      {name:"Shani",longitude:Astronomy.saturnLongitude(jd)}
    ];
  }

  function drawChart(planets,asc,container){
    const svgNS="http://www.w3.org/2000/svg";
    container.innerHTML="";
    const size=Math.min(600,window.innerWidth-40);
    const svg=document.createElementNS(svgNS,"svg");
    svg.setAttribute("width",size);
    svg.setAttribute("height",size);
    svg.setAttribute("viewBox","0 0 600 600");
    svg.style.maxWidth="100%";
    container.appendChild(svg);

    const pts="300,20 580,300 300,580 20,300";
    const diamond=document.createElementNS(svgNS,"polygon");
    diamond.setAttribute("points",pts);
    diamond.setAttribute("stroke","#ff9b31");
    diamond.setAttribute("stroke-width","5");
    diamond.setAttribute("fill","none");
    diamond.setAttribute("filter","drop-shadow(0 0 9px #ff9b3199)");
    svg.appendChild(diamond);

    const lines=[[20,300,300,580],[300,580,580,300],[580,300,300,20],[300,20,20,300]];
    lines.forEach(([x1,y1,x2,y2])=>{
      const line=document.createElementNS(svgNS,"line");
      line.setAttribute("x1",x1);
      line.setAttribute("y1",y1);
      line.setAttribute("x2",x2);
      line.setAttribute("y2",y2);
      line.setAttribute("stroke","#ff9b31");
      line.setAttribute("stroke-width","3");
      svg.appendChild(line);
    });
    const houseCenters=[[300,125],[420,195],[455,335],[420,465],[300,525],[180,460],[145,325],[180,190],[300,300],[360,230],[300,180],[240,230]];
    const ascSignIndex=Math.floor(asc/30);
    for(let i=0;i<12;i++){
      const houseNum=((ascSignIndex+i)%12)+1;
      const [x,y]=houseCenters[i];
      const text=document.createElementNS(svgNS,"text");
      text.setAttribute("x",x);
      text.setAttribute("y",y-20);
      text.setAttribute("fill","#ff9b31");
      text.setAttribute("font-size","20");
      text.setAttribute("font-weight","900");
      text.setAttribute("text-anchor","middle");
      text.textContent=houseNum;
      svg.appendChild(text);
    }
    const cx=300,cy=300,radius=230;
    planets.forEach(({name,longitude})=>{
      const relAngle=(longitude-asc+360)%360;
      const angleRad=(relAngle-90)*Math.PI/180;
      const px=cx+radius*Math.cos(angleRad);
      const py=cy+radius*Math.sin(angleRad);
      const circle=document.createElementNS(svgNS,"circle");
      circle.setAttribute("cx",px);
      circle.setAttribute("cy",py);
      circle.setAttribute("r",20);
      circle.setAttribute("class","planet-circle");
      circle.setAttribute("title",`${name}: ${formatLongitude(longitude)}`);
      circle.style.fill="#ff7f27";
      circle.style.stroke="#ffefb1";
      svg.appendChild(circle);
      const text=document.createElementNS(svgNS,"text");
      text.setAttribute("x",px);
      text.setAttribute("y",py+40);
      text.setAttribute("fill","#ffa444");
      text.setAttribute("font-weight","900");
      text.setAttribute("font-size","16");
      text.setAttribute("text-anchor","middle");
      text.style.userSelect="none";
      text.textContent=name;
      svg.appendChild(text);
    });
  }

  astrologyForm.addEventListener("submit",e=>{
    e.preventDefault();
    const dob=astrologyForm.dob.value;
    const tob=astrologyForm.tob.value;
    const lat=parseFloat(astrologyForm.lat.value);
    const lng=parseFloat(astrologyForm.lng.value);
    if(!dob||!tob||isNaN(lat)||isNaN(lng)){
      alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Ç‡§∞‡•Ä ‡§î‡§∞ ‡§∏‡§π‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§");
      return;
    }
    const [hour,minute]=tob.split(":").map(Number);
    const [year,month,day]=dob.split("-").map(Number);
    const jd=Astronomy.toJulianDay(year,month,day,hour,minute);
    const planets=calculatePlanets(jd);
    const ascendant=((()=> {
      const eps=23.4397;
      let GST=Astronomy.greenwichSiderealTime(jd);
      let LST=(GST+lng)%360;
      if(LST<0)LST+=360;
      const radLat=Astronomy.degToRad(lat);
      const radEps=Astronomy.degToRad(eps);
      const radLST=Astronomy.degToRad(LST);
      let asc=Math.atan2(-Math.cos(radLST),Math.sin(radLST)*Math.cos(radEps)-Math.tan(radLat)*Math.sin(radEps));
      if(asc<0)asc+=2*Math.PI;
      return Astronomy.radToDeg(asc);
    })());
    drawChart(planets,asc,chartContainer);
    analysisBasic.textContent=`‡§Ü‡§™‡§ï‡§æ ‡§ú‡§®‡•ç‡§Æ ‡§µ‡§ø‡§µ‡§∞‡§£:\n- ‡§§‡§ø‡§•‡§ø: ${dob}\n- ‡§∏‡§Æ‡§Ø: ${tob}\n- ‡§Ö‡§ï‡•ç‡§∑‡§æ‡§Ç‡§∂: ${lat.toFixed(4)}\n- ‡§¶‡•á‡§∂‡§æ‡§Ç‡§§‡§∞: ${lng.toFixed(4)}\n\n`+
      `‡§â‡§¶‡§Ø ‡§∞‡§æ‡§∂‡§ø (Ascendant): ${formatLongitude(ascendant)}\n\n`+
      `‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø:\n`+planets.map(p=>`‚Ä¢ ${p.name}: ${formatLongitude(p.longitude)}`).join("\n");
    btnAnalysis.style.display="block";
    analysisDetailed.style.display="none";
    analysisDetailed.textContent="";
  });

  btnAnalysis.addEventListener("click",()=>{
    let textLines=[];
    textLines.push("‚ú® ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ kundli ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‚ú®\n");
    textLines.push(analysisBasic.textContent);
    textLines.push("\n‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§ï‡§æ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§î‡§∞ ‡§∏‡§Ç‡§ï‡•á‡§§:");
    function planetSignEffect(name,lon){
      let signIndex=Math.floor(lon/30);
      let sign=signs[signIndex];
      switch(name){
        case"Surya":return`‡§∏‡•Ç‡§∞‡•ç‡§Ø ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§®‡•á‡§§‡•É‡§§‡•ç‡§µ ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§î‡§∞ ‡§Ü‡§§‡•ç‡§Æ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§¨‡§¢‡§º‡§§‡•á ‡§π‡•à‡§Ç‡•§`;
        case"Chandra":return`‡§ö‡§®‡•ç‡§¶‡•ç‡§∞ ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§á‡§∏‡§ï‡§æ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§≠‡§æ‡§µ‡§®‡§æ‡§ì‡§Ç ‡§î‡§∞ ‡§Æ‡§æ‡§®‡§∏‡§ø‡§ï ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§™‡§∞ ‡§™‡§°‡§º‡§§‡§æ ‡§π‡•à‡•§`;
        case"Budh":return`‡§¨‡•Å‡§ß ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø ‡§î‡§∞ ‡§∏‡§Ç‡§µ‡§æ‡§¶ ‡§ï‡•å‡§∂‡§≤ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§`;
        case"Shukra":return`‡§∂‡•Å‡§ï‡•ç‡§∞ ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§ú‡•ã ‡§™‡•ç‡§∞‡•á‡§Æ, ‡§∏‡•å‡§Ç‡§¶‡§∞‡•ç‡§Ø ‡§î‡§∞ ‡§∏‡§æ‡§Æ‡§æ‡§ú‡§ø‡§ï ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡•ã‡§Ç ‡§™‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§°‡§æ‡§≤‡§§‡§æ ‡§π‡•à‡•§`;
        case"Mangal":return`‡§Æ‡§Ç‡§ó‡§≤ ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§ú‡•ã ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§î‡§∞ ‡§∏‡§æ‡§π‡§∏ ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à‡•§`;
        case"Guru":return`‡§ó‡•Å‡§∞‡•Å ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à, ‡§ú‡•ã ‡§ú‡•ç‡§û‡§æ‡§® ‡§î‡§∞ ‡§Ü‡§ß‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ø‡§ï‡§§‡§æ ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•à‡•§`;
        case"Shani":return`‡§∂‡§®‡§ø ${sign} ‡§∞‡§æ‡§∂‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§Ö‡§°‡§º‡§ö‡§®‡•ã‡§Ç ‡§è‡§µ‡§Ç ‡§Ö‡§®‡•Å‡§∂‡§æ‡§∏‡§® ‡§ï‡•á ‡§ï‡§æ‡§∞‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§`;
        default:return`${name} ‡§ó‡•ç‡§∞‡§π ‡§ï‡•á ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§®‡§æ‡§ß‡•Ä‡§® ‡§π‡•à‡§Ç‡•§`;
      }
    }
    const ascText=analysisBasic.textContent.split("\n").find(l=>l.startsWith("‡§â‡§¶‡§Ø ‡§∞‡§æ‡§∂‡§ø"));
    textLines.push(ascText.replace("‡§â‡§¶‡§Ø ‡§∞‡§æ‡§∂‡§ø (Ascendant):","‡§â‡§¶‡§Ø ‡§∞‡§æ‡§∂‡§ø:"));
    const planetLines=analysisBasic.textContent.split("\n").filter(l=>l.startsWith("‚Ä¢"));
    planetLines.forEach(planetLine=>{
      const [pname,plong]=planetLine.replace("‚Ä¢ ","").split(":");
      const plon=parseFloat(plong);
      if(!isNaN(plon))
        textLines.push(`- ${planetSignEffect(pname.trim(),plon)}`);
      else textLines.push(`- ${pname.trim()} ‡§ó‡•ç‡§∞‡§π ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç‡•§`);
    });
    textLines.push("\n‡§Ø‡§π ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ó‡•ç‡§∞‡§π‡•ã‡§Ç ‡§î‡§∞ ‡§â‡§¶‡§Ø ‡§∞‡§æ‡§∂‡§ø ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§");
    textLines.push("‡§Ö‡§ß‡§ø‡§ï ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§ú‡•ç‡§Ø‡•ã‡§§‡§ø‡§∑‡•Ä‡§Ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§ú‡•ç‡§Ø‡•ã‡§§‡§ø‡§∑‡•Ä ‡§∏‡•á ‡§∏‡§Æ‡•ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§");
    analysisDetailed.textContent=textLines.join("\n");
    analysisDetailed.style.display="block";
    btnAnalysis.style.display="none";
    setTimeout(()=>{analysisDetailed.scrollIntoView({behavior:"smooth"})},80);
  });

  // Traditional Kundli Section (Advanced with houses and planet positions in houses)
  const tradForm=document.getElementById("tradForm");
  const tradChartContainer=document.getElementById("trad-chart-container");
  const tradCitySelect=document.getElementById("tradCity");
  const tradLatInput=document.getElementById("tradLat");
  const tradLngInput=document.getElementById("tradLng");
  tradCitySelect.addEventListener("change",e=>{
    const val=e.target.value;
    if(val){
      const [lat,lng]=val.split(",");
      tradLatInput.value=lat;
      tradLngInput.value=lng;
    }
  });

  tradForm.addEventListener("submit",e=>{
    e.preventDefault();
    const dob=tradForm.tradDob.value;
    const tob=tradForm.tradTob.value;
    const lat=parseFloat(tradForm.tradLat.value);
    const lng=parseFloat(tradForm.tradLng.value);
    if(!dob||!tob||isNaN(lat)||isNaN(lng)){
      alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§ú‡§®‡•ç‡§Æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç‡•§");
      return;
    }
    const [hour,minute]=tob.split(":").map(Number);
    const [year,month,day]=dob.split("-").map(Number);
    const JD=Astronomy.toJulianDay(year,month,day,hour,minute);

    const ascendant=(function(JD,lat,lon){
      const eps=23.4397;
      let GST=Astronomy.greenwichSiderealTime(JD);
      let LST=(GST+lon)%360;
      if(LST<0) LST+=360;
      const radLat=Astronomy.degToRad(lat);
      const radEps=Astronomy.degToRad(eps);
      const radLST=Astronomy.degToRad(LST);
      let asc=Math.atan2(-Math.cos(radLST),Math.sin(radLST)*Math.cos(radEps)-Math.tan(radLat)*Math.sin(radEps));
      if(asc<0)asc+=2*Math.PI;
      return Astronomy.radToDeg(asc);
    })(JD,lat,lng);

    const planets=calculatePlanets(JD);
    // House assignments -- equal houses from ascendant as house 1
    let houses=Array.from({length:12},()=>[]);
    planets.forEach(p=>{
      let diff=p.longitude-ascendant;
      if(diff<0) diff+=360;
      let houseNum=Math.floor(diff/30);
      houses[houseNum].push(p.name);
    });

    renderTraditionalKundli(houses, tradChartContainer);
  });

  function renderTraditionalKundli(houses, container) {
    container.innerHTML="";
    const div=document.createElement("div");
    div.style.position="relative";
    div.style.width="600px";
    div.style.height="600px";
    div.style.margin="auto";
    const svgNS="http://www.w3.org/2000/svg";
    const svg=document.createElementNS(svgNS,"svg");
    svg.setAttribute("width","600");
    svg.setAttribute("height","600");
    svg.style.position="absolute";
    svg.style.top=0; svg.style.left=0; svg.style.zIndex=1;
    const diamondPoints="300,20 580,300 300,580 20,300";
    const diamond=document.createElementNS(svgNS,"polygon");
    diamond.setAttribute("points",diamondPoints);
    diamond.setAttribute("stroke","#ffa832");
    diamond.setAttribute("stroke-width","5");
    diamond.setAttribute("fill","none");
    diamond.setAttribute("filter","drop-shadow(0 0 12px #ffa832cc)");
    svg.appendChild(diamond);
    div.appendChild(svg);

    const houseCenters=[[300,125],[420,195],[455,335],[420,465],[300,525],[180,460],
                        [145,325],[180,190],[300,300],[360,230],[300,180],[240,230]];

    houses.forEach((planets,i)=>{
      const houseDiv=document.createElement("div");
      houseDiv.style.position="absolute";
      houseDiv.style.left=houseCenters[i][0]-75+"px";
      houseDiv.style.top=houseCenters[i][1]-60+"px";
      houseDiv.style.width="150px";
      houseDiv.style.height="110px";
      houseDiv.style.border="2px solid #ffb14f";
      houseDiv.style.borderRadius="22px";
      houseDiv.style.background="rgba(255,168,80,0.18)";
      houseDiv.style.color="#ffc973";
      houseDiv.style.fontWeight="700";
      houseDiv.style.fontSize="20px";
      houseDiv.style.textAlign="center";
      houseDiv.style.paddingTop="8px";
      houseDiv.style.textShadow="0 0 9px #b77a00cc";
      houseDiv.style.userSelect="none";

      let houseNumLabel=document.createElement("div");
      houseNumLabel.textContent=`‡§ò‡§∞ ${i+1}`;
      houseNumLabel.style.fontSize="19px";
      houseNumLabel.style.fontWeight="800";
      houseNumLabel.style.color="#ff9c30";
      houseNumLabel.style.textShadow="0 0 9px #cc7f2d";
      houseDiv.appendChild(houseNumLabel);

      if(planets.length===0){
        let noPlanet=document.createElement("div");
        noPlanet.textContent="‡§ï‡•ã‡§à ‡§ó‡•ç‡§∞‡§π ‡§®‡§π‡•Ä‡§Ç";
        noPlanet.style.fontSize="17px";
        noPlanet.style.color="#fbba51";
        houseDiv.appendChild(noPlanet);
      } else {
        planets.forEach(p=>{
          let pDiv=document.createElement("div");
          pDiv.textContent=p;
          pDiv.style.fontSize="18px";
          pDiv.style.color="#ffe3a3";
          pDiv.style.marginTop="2px";
          houseDiv.appendChild(pDiv);
        });
      }
      div.appendChild(houseDiv);
    });
    container.appendChild(div);
  }

  /* Numerology Section */
  const numForm=document.getElementById("numForm");
  const numAnalysis=document.getElementById("num-analysis");

  numForm.addEventListener("submit",e=>{
    e.preventDefault();
    const name=numForm.numName.value.trim().toLowerCase();
    const dob=numForm.numDob.value;
    if(!name||!dob){
      alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§ú‡§®‡•ç‡§Æ‡§§‡§ø‡§•‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§");
      return;
    }
    let result = calculateFullNumerology(name,dob);
    numAnalysis.textContent=result;
  });

  // Full numerology calculations returning detailed report
  function calculateFullNumerology(name,dob){
    // Helper functions inside
    function sumToSingleDigit(arr){
      let total=arr.reduce((a,b)=>a+b,0);
      while(total>9 && total!==11 && total!==22){
        total=total.toString().split("").reduce((a,b)=>a+parseInt(b),0);
      }
      return total;
    }
    function letterToNumber(ch){
      const map={
        a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,
        j:1,k:2,l:3,m:4,n:5,o:6,p:7,q:8,r:9,
        s:1,t:2,u:3,v:4,w:5,x:6,y:7,z:8
      };
      return map[ch]||0;
    }
    function numerologyDesc(num){
      const dict={
        1:"‡§®‡•á‡§§‡•É‡§§‡•ç‡§µ, ‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞‡§§‡§æ, ‡§∞‡§ö‡§®‡§æ‡§§‡•ç‡§Æ‡§ï‡§§‡§æ, ‡§Æ‡§π‡§§‡•ç‡§µ‡§æ‡§ï‡§æ‡§Ç‡§ï‡•ç‡§∑‡§æ‡•§",
        2:"‡§∏‡§π‡§Ø‡•ã‡§ó, ‡§∏‡§Ç‡§§‡•Å‡§≤‡§®, ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ, ‡§∂‡§æ‡§Ç‡§§‡§ø‡•§",
        3:"‡§∏‡§Ç‡§ö‡§æ‡§∞, ‡§Ü‡§®‡§Ç‡§¶, ‡§Ö‡§≠‡§ø‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø, ‡§∞‡§ö‡§®‡§æ‡§§‡•ç‡§Æ‡§ï‡§§‡§æ‡•§",
        4:"‡§Æ‡•á‡§π‡§®‡§§, ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§¶‡•ç‡§ß‡§§‡§æ, ‡§∏‡§Ç‡§ó‡§†‡§®‡•§",
        5:"‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞‡§§‡§æ, ‡§â‡§§‡•ç‡§∏‡§æ‡§π, ‡§∏‡§æ‡§π‡§∏, ‡§≤‡§ö‡•Ä‡§≤‡§æ‡§™‡§®‡•§",
        6:"‡§ï‡§∞‡•Å‡§£‡§æ, ‡§®‡•à‡§§‡§ø‡§ï‡§§‡§æ, ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä‡•§",
        7:"‡§Ü‡§ß‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ø‡§ï‡§§‡§æ, ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£, ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§§‡•ç‡§§‡§æ‡•§",
        8:"‡§∂‡§ï‡•ç‡§§‡§ø, ‡§∏‡§´‡§≤‡§§‡§æ, ‡§µ‡§ø‡§§‡•ç‡§§‡•Ä‡§Ø ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§Æ‡§§‡•ç‡§§‡§æ‡•§",
        9:"‡§Æ‡§æ‡§®‡§µ‡§§‡§æ, ‡§∏‡§π‡§æ‡§®‡•Å‡§≠‡•Ç‡§§‡§ø, ‡§â‡§¶‡§æ‡§∞‡§§‡§æ‡•§",
        11:"‡§â‡§ö‡•ç‡§ö ‡§ö‡•á‡§§‡§®‡§æ, ‡§™‡•ç‡§∞‡•á‡§∞‡§ï, ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡•§",
        22:"‡§Æ‡§π‡§æ‡§® ‡§®‡§ø‡§∞‡•ç‡§Æ‡§æ‡§§‡§æ, ‡§ó‡•Å‡§∞‡•Å, ‡§Æ‡•à‡§≤ ‡§ï‡§æ ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§¶‡§ø‡§®‡•§"
      };
      return dict[num]||"‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç‡•§";
    }

    const digits=dob.replace(/\D/g,"").split("").map(n=>parseInt(n));
    const lifePath=sumToSingleDigit(digits);

    const charNums=name.replace(/[^a-z]/g,"").split("").map(letterToNumber);
    const expressionNum=sumToSingleDigit(charNums);

    // Soul Urge = vowels in name
    const vowels="aeiou";
    const soulNums=name.split("").filter(ch=>vowels.includes(ch)).map(letterToNumber);
    const soulUrgeNum=sumToSingleDigit(soulNums);

    // Karmic Debt Numbers detection (13,14,16,19 special)
    const karmicDebts=[13,14,16,19];
    const karmicDetections=karmicDebts.filter(n=>charNums.includes(n));

    // Pinnacle Numbers Examples (lifeless but demo purpose)
    const pinnacle1=lifePath%9||9;
    const pinnacle2=expressionNum%9||9;

    let result=`üî¢ Numerology Detailed Report:\n\n`;
    result+=`‚Ä¢ Life Path Number (‡§ú‡§º‡§ø‡§Ç‡§¶‡§ó‡•Ä ‡§ï‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ó): ${lifePath}\n  ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ: ${numerologyDesc(lifePath)}\n\n`;
    result+=`‚Ä¢ Expression Number (‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§§‡•ç‡§µ ‡§Ö‡§Ç‡§ï): ${expressionNum}\n  ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ: ${numerologyDesc(expressionNum)}\n\n`;
    result+=`‚Ä¢ Soul Urge Number (‡§Ü‡§§‡•ç‡§Æ‡§æ ‡§á‡§ö‡•ç‡§õ‡§æ ‡§Ö‡§Ç‡§ï): ${soulUrgeNum}\n  ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ: ${numerologyDesc(soulUrgeNum)}\n\n`;

    if(karmicDetections.length>0){
      result+=`‚Ä¢ Karmic Debt Numbers (‡§ï‡§æ‡§∞‡•ç‡§Æ‡§ø‡§ï ‡§ã‡§£): ${karmicDetections.join(", ")}\n  ‡§Ø‡•á ‡§Ü‡§™‡§ï‡•á ‡§Ü‡§§‡•ç‡§Æ‡§ø‡§ï ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç‡•§\n\n`;
    } else{
      result+=`‚Ä¢ Karmic Debt Numbers: Not detected\n\n`;
    }

    result+=`‚Ä¢ Pinnacle Numbers (‡§ú‡•Ä‡§µ‡§® ‡§ï‡•á ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡§°‡§º‡§æ‡§µ):\n   ‡§™‡§π‡§≤‡§æ ‡§™‡§°‡§º‡§æ‡§µ: ${pinnacle1}\n   ‡§¶‡•Ç‡§∏‡§∞‡§æ ‡§™‡§°‡§º‡§æ‡§µ: ${pinnacle2}\n\n`;
    result+=`‚ö†Ô∏è ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç, ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§Ö‡§ß‡•ç‡§Ø‡§Ø‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§`;
    return result;
  }

  /* Dasha Section */
  const dashaForm=document.getElementById("dashaForm");
  const dashaResult=document.getElementById("dasha-result");

  dashaForm.addEventListener("submit",e=>{
    e.preventDefault();
    const dob=dashaForm.dashaDob.value;
    const tob=dashaForm.dashaTob.value;
    if(!dob||!tob){
      alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§ú‡§®‡•ç‡§Æ ‡§ï‡•Ä ‡§§‡§ø‡§•‡§ø ‡§è‡§µ‡§Ç ‡§∏‡§Æ‡§Ø ‡§∏‡§π‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§");
      return;
    }
    const [year,month,day]=dob.split("-").map(Number);
    const [hour,minute]=tob.split(":").map(Number);
    const JD=Astronomy.toJulianDay(year,month,day,hour,minute);

    // Simplified Moon longitude nakshatra & Vimshottari Dasha
    const moonLon=Astronomy.moonLongitude(JD);
    const nakshatraNum=Math.floor(moonLon/(360/27));
    const dashaList=[
      {name:"‡§ï‡•á‡§§‡•Å",duration:7},
      {name:"‡§∂‡§®‡§ø",duration:19},
      {name:"‡§¨‡•Å‡§ß",duration:17},
      {name:"‡§ó‡•Å‡§∞‡•Å",duration:16},
      {name:"‡§∂‡•Å‡§ï‡•ç‡§∞",duration:20},
      {name:"‡§∏‡•Ç‡§∞‡•ç‡§Ø",duration:6},
      {name:"‡§ö‡§®‡•ç‡§¶‡•ç‡§∞",duration:10},
      {name:"‡§Æ‡§Ç‡§ó‡§≤",duration:7},
      {name:"‡§∞‡§æ‡§π‡•Å",duration:18}
    ];

    let startIndex=nakshatraNum%9;
    let text="‚ú® Vimshottari Dasha ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‚ú®\n\n";
    text+=`‡§ú‡§®‡•ç‡§Æ ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ: ${nakshatraNum+1}\n\n‡§°‡§∂‡§æ ‡§∏‡•Ç‡§ö‡•Ä (‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§Æ‡•á‡§Ç):\n`;

    for(let i=0;i<9;i++){
      let idx=(startIndex+i)%9;
      const d=dashaList[idx];
      text+=`- ${d.name}: ${d.duration} ‡§µ‡§∞‡•ç‡§∑\n`;
    }
    text+=`\n‡§Ø‡§π ‡§∏‡§∞‡§≤‡•Ä‡§ï‡•É‡§§ ‡§°‡§∂‡§æ ‡§ó‡§£‡§®‡§æ ‡§π‡•à‡•§ ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§ú‡•ç‡§Ø‡•ã‡§§‡§ø‡§∑‡•Ä‡§Ø ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑‡§ú‡•ç‡§û ‡§∏‡•á ‡§∏‡§≤‡§æ‡§π ‡§≤‡•á‡§Ç‡•§`;
    dashaResult.textContent=text;
  });
</script>
</body>
</html>
